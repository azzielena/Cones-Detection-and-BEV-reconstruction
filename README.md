# 📌 Cones Detection and BEV Reconstruction 

## 📖 Project Description - Supervised Roadway Reconstruction with Cones
This project was developed by **[Arianna Cella](https://github.com/ariannaCella)** and **[Elena Azzi](https://github.com/azzielena)** for the course "**AUTONOMOUS DRIVING AND ADAS TECHNOLOGIES**" at the University of Parma. The goal of the project was to develop a supervised learning neural network aimed at reconstructing the roadway. It uses the positions of the **blue** and **yellow cones** in **world coordinates**, which define the boundaries of the roadway.

### 📂 Initial Input
Files containing (x, y) coordinates of yellow and blue cones collected from specific frames.

### 🛣️ Goal
Reconstruction of roadway boundaries and the centerline.

## 🔄 Project Development Pipeline

### 1️⃣ Dataset Preprocessing
✔️ Feature selection to remove unclear or erroneous frames and apply transformations to standardize the data.

✔️ Data augmentation to enrich the dataset and enhance the model's robustness.

✔️ Conversion into a grid format to serve as input for the neural network.

### 2️⃣ Neural Network Model Development
🧠 Various neural network models were developed and tested to identify the most suitable architecture for solving the problem.

### 3️⃣ Performance Evaluation and Results Visualization
📈 Evaluating the model's effectiveness in reconstructing the road and accurately localizing the cones.

## 📂 Repository Structure
Here’s how to navigate through the repository:

- **`data_preprocessing/`** ➝ Initial data preprocessing.
  - `sequenze/` ➝ Contains input datasets with cone coordinates.
  - `create_initial_dataset.py` ➝ Extracts the most relevant inputs by removing invalid ones.
  - `create_centered_dataset.py` ➝ Standardizes the inputs, aligning all roadways to start from position (0,0).
    
- **`data_augmentation/`** ➝ Includes files that apply rotation and flipping along the x-axis to increase the number of available inputs.
  
- **`supporting_dataset/`** ➝ Contains the intermediate datasets generated by the preprocessing and data augmentation phase
  
- **`data_CSV/`** ➝ Contains the files responsible for transforming the inputs into a grid and saving them in two separate CSV files: one for the inputs and one for the outputs.
  
- **`dataset/`** ➝ The final dataset used for training and evaluating the network.
  - `final_dataset/` ➝ Contains the final coordinates of the input and output cones.
  - `grid_input.csv` ➝ CSV file representing the grids containing the coordinates of the input blue and yellow cones.
  - `grid_output.csv` ➝ CSV file representing the grids containing the curves that define the roadway, which the network is trained to predict.
    
- **`Nets/`** ➝ Comparison of different neural network models.
  - `model_result/` ➝ Folder where the trained network models will be saved.
  - `models_net/` ➝ Developed networks.
  - `utils.py` ➝ Support functions.
  - `training_model.py` ➝ File for training the network.
  - `test_visual_model.py` ➝ File for evaluating the network's performance and visualizing the results.
    
- **`model_UNet/`** ➝ **Main project folder** for training and evaluating the **UNET** network.
  - `model_result/` ➝ Folder where the trained network models will be saved.
  - `models_net/` ➝ Developed UNET networks.
  - `utils.py` ➝ Support functions.
  - `training_model.py` ➝ File for training the network.
  - `test_visual_model.py` ➝ File for evaluating the network's performance and visualizing the results.


## 🚀 How to Use the Project
To train the main **UNET** model and visualize the results obtained in solving the roadway identification problem, follow the steps described below.

### 1️⃣ Clone the Repository
```bash
git clone https://github.com/azzielena/Cones-Detection-and-BEV-reconstruction.git
cd Cones-Detection-and-BEV-reconstruction
```

### 2️⃣ Install Dependencies
It is recommended to use a virtual environment:
```bash
pip install -r requirements.txt
```

### 3️⃣ Start Training
```bash
python model_UNet/training_model.py
```

### 4️⃣ Evaluate Results
```bash
python model_UNet/test_visual_model.py
```

## 🎨 Results Visualization
The reconstructed roadway results can be viewed by running the file `test_visual_model.py`, which allows for a graphical visualization of the roadway reconstruction after training the neural network.

## 🤝 Contributions
This project was developed by **[Arianna Cella](https://github.com/ariannaCella)** and **[Elena Azzi](https://github.com/azzielena)**.

If you would like to contribute, feel free to open an Issue or submit a Pull Request! 🎉
